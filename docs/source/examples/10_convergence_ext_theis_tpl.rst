
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/10_convergence_ext_theis_tpl.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_10_convergence_ext_theis_tpl.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_10_convergence_ext_theis_tpl.py:


Convergence of the extended Theis solutions for truncated power laws
====================================================================

Here we set an outer boundary to the transient solution, so this condition
coincides with the references head of the steady solution.

Reference: (not yet published)

.. GENERATED FROM PYTHON SOURCE LINES 10-42



.. image:: /examples/images/sphx_glr_10_convergence_ext_theis_tpl_001.png
    :alt: 10 convergence ext theis tpl
    :class: sphx-glr-single-img





.. code-block:: default

    import numpy as np
    from matplotlib import pyplot as plt
    from anaflow import ext_theis_tpl, ext_thiem_tpl

    time = 1e4  # time point for steady state
    rad = np.geomspace(0.1, 10)  # radius from the pumping well in [0, 4]
    r_ref = 10.0  # reference radius

    KG = 1e-4  # the geometric mean of the transmissivity
    len_scale = 5.0  # correlation length of the log-transmissivity
    hurst = 0.5  # hurst coefficient
    var = 0.5  # variance of the log-transmissivity
    dim = 1.5  # using a fractional dimension

    S = 1e-4  # storativity
    rate = -1e-4  # pumping rate

    head1 = ext_thiem_tpl(
        rad, r_ref, KG, len_scale, hurst, var, dim=dim, rate=rate
    )
    head2 = ext_theis_tpl(
        time, rad, S, KG, len_scale, hurst, var, dim=dim, rate=rate, r_bound=r_ref
    )

    plt.plot(rad, head1, label="Ext Thiem TPL")
    plt.plot(rad, head2, label="Ext Theis TPL (t={})".format(time), linestyle="--")

    plt.xlabel("r in [m]")
    plt.ylabel("h in [m]")
    plt.legend()
    plt.tight_layout()
    plt.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.955 seconds)


.. _sphx_glr_download_examples_10_convergence_ext_theis_tpl.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: 10_convergence_ext_theis_tpl.py <10_convergence_ext_theis_tpl.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: 10_convergence_ext_theis_tpl.ipynb <10_convergence_ext_theis_tpl.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
